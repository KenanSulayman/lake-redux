// Generated by CoffeeScript 1.8.0
(function() {
  var createMakefiles, debug, nopt, pkg;

  nopt = require('nopt');

  debug = require('debug')('local-make');

  pkg = require('../package');

  createMakefiles = require('./create_makefile').createMakefiles;

  module.exports.build = function() {
    var err, knownOpts, parsedArgs, shortHands;
    knownOpts = {
      input: [String, Array],
      output: String,
      help: String,
      version: Boolean
    };
    shortHands = {
      i: ['--input'],
      o: ['--output'],
      h: ['--help'],
      v: ['--version']
    };
    parsedArgs = nopt(knownOpts, shortHands, process.argv, 2);
    if (parsedArgs.version) {
      console.log(pkg.version);
      process.exit(0);
    }
    if (parsedArgs.help) {
      console.log('USAGE');
      console.dir(shortHands);
      process.exit(0);
    }
    debug('createMakefiles');
    err = createMakefiles(parsedArgs.input, parsedArgs.output);
    if (err != null) {
      console.error(err.message);
      return process.exit(1);
    } else {
      return process.exit(0);
    }
  };

}).call(this);
